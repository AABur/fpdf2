



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Simple PDF generation for Python (FPDF PHP port) [FORK]">
      
      
        <link rel="canonical" href="https://alexanderankin.github.io/pyfpdf/Web2Py.html">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.3">
    
    
      
        <title>Introduction # - PyFPDF</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/application.30686662.css">
      
      
    
    
      <script src="assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#introduction" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://alexanderankin.github.io/pyfpdf/" title="PyFPDF" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              PyFPDF
            </span>
            <span class="md-header-nav__topic">
              
                Introduction #
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/alexanderankin/pyfpdf/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://alexanderankin.github.io/pyfpdf/" title="PyFPDF" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    PyFPDF
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/alexanderankin/pyfpdf/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="index.html" title="Project Home" class="md-nav__link">
      Project Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="Tutorial.html" title="Tutorial" class="md-nav__link">
      Tutorial
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Tutorial Translations
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Tutorial Translations
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="Tutorial-es.html" title="Tutorial (Spanish translation)" class="md-nav__link">
      Tutorial (Spanish translation)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="FAQ.html" title="FAQ" class="md-nav__link">
      FAQ
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="Development.html" title="Development" class="md-nav__link">
      Development
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="Templates.html" title="Templates" class="md-nav__link">
      Templates
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="Unicode.html" title="Unicode" class="md-nav__link">
      Unicode
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      ReferenceManual
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        ReferenceManual
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="ReferenceManual.html" title="Reference Manual" class="md-nav__link">
      Reference Manual
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/accept_page_break.html" title="accept_page_break" class="md-nav__link">
      accept_page_break
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/add_font.html" title="add_font" class="md-nav__link">
      add_font
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/add_link.html" title="add_link" class="md-nav__link">
      add_link
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/add_page.html" title="add_page" class="md-nav__link">
      add_page
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/alias_nb_pages.html" title="alias_nb_pages" class="md-nav__link">
      alias_nb_pages
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/cell.html" title="cell" class="md-nav__link">
      cell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/close.html" title="close" class="md-nav__link">
      close
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/dashed_line.html" title="dashed_line" class="md-nav__link">
      dashed_line
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/ellipse.html" title="ellipse" class="md-nav__link">
      ellipse
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/error.html" title="error" class="md-nav__link">
      error
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/FPDF.html" title="FPDF" class="md-nav__link">
      FPDF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/footer.html" title="footer" class="md-nav__link">
      footer
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/get_string_width.html" title="get_string_width" class="md-nav__link">
      get_string_width
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/get_x.html" title="get_x" class="md-nav__link">
      get_x
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/get_y.html" title="get_y" class="md-nav__link">
      get_y
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/header.html" title="header" class="md-nav__link">
      header
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/image.html" title="image" class="md-nav__link">
      image
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/load_resource.html" title="load_resource" class="md-nav__link">
      load_resource
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/line.html" title="line" class="md-nav__link">
      line
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/link.html" title="link" class="md-nav__link">
      link
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/ln.html" title="ln" class="md-nav__link">
      ln
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/multi_cell.html" title="multi_cell" class="md-nav__link">
      multi_cell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/open.html" title="open" class="md-nav__link">
      open
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/output.html" title="output" class="md-nav__link">
      output
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/page_no.html" title="page_no" class="md-nav__link">
      page_no
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/rect.html" title="rect" class="md-nav__link">
      rect
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/set_author.html" title="set_author" class="md-nav__link">
      set_author
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/set_auto_page_break.html" title="set_auto_page_break" class="md-nav__link">
      set_auto_page_break
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/set_compression.html" title="set_compression" class="md-nav__link">
      set_compression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/set_creator.html" title="set_creator" class="md-nav__link">
      set_creator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/set_doc_option.html" title="set_doc_option" class="md-nav__link">
      set_doc_option
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/set_display_mode.html" title="set_display_mode" class="md-nav__link">
      set_display_mode
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/set_draw_color.html" title="set_draw_color" class="md-nav__link">
      set_draw_color
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/set_fill_color.html" title="set_fill_color" class="md-nav__link">
      set_fill_color
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/set_font.html" title="set_font" class="md-nav__link">
      set_font
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/set_font_size.html" title="set_font_size" class="md-nav__link">
      set_font_size
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/set_keywords.html" title="set_keywords" class="md-nav__link">
      set_keywords
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/set_left_margin.html" title="set_left_margin" class="md-nav__link">
      set_left_margin
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/set_line_width.html" title="set_line_width" class="md-nav__link">
      set_line_width
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/set_link.html" title="set_link" class="md-nav__link">
      set_link
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/set_margins.html" title="set_margins" class="md-nav__link">
      set_margins
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/set_right_margin.html" title="set_right_margin" class="md-nav__link">
      set_right_margin
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/set_stretching.html" title="set_stretching" class="md-nav__link">
      set_stretching
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/set_subject.html" title="set_subject" class="md-nav__link">
      set_subject
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/set_text_color.html" title="set_text_color" class="md-nav__link">
      set_text_color
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/set_title.html" title="set_title" class="md-nav__link">
      set_title
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/set_top_margin.html" title="set_top_margin" class="md-nav__link">
      set_top_margin
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/set_x.html" title="set_x" class="md-nav__link">
      set_x
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/set_xy.html" title="set_xy" class="md-nav__link">
      set_xy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/set_y.html" title="set_y" class="md-nav__link">
      set_y
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/text.html" title="text" class="md-nav__link">
      text
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/write.html" title="write" class="md-nav__link">
      write
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reference/write_html.html" title="write_html" class="md-nav__link">
      write_html
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/alexanderankin/pyfpdf/edit/master/mkdocs_docs/Web2Py.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="introduction">Introduction</h1>
<p>If you use <a href="http://www.web2py.com">web2py</a>, you can make complex reports that can be viewed in a browser, or downloaded as PDF (taking advantage of web2py HTML helper objects to easily diagram a report). See <a href="reference/write_html.html">write_html</a> for more information, supported tags and attributes, etc.</p>
<p>Also, using web2py DAL, you can easily set up a templating engine for PDF documents. See <a href="Templates.html">Templates</a> for more information.</p>
<p>The following examples are packaged in a ready to run application:
<a href="http://pyfpdf.googlecode.com/files/web2py.app.fpdf.w2p">web2py.app.fpdf.w2p</a>.</p>
<p>PyFPDF is included in <a href="http://www.web2py.com/">web2py</a> since release <a href="http://www.web2py.com/examples/default/download">1.85.2</a>.</p>
<p>Also, you can download the latest version of <a href="http://pyfpdf.googlecode.com/files/pyfpdf-1.54b.zip">pyfpdf</a> and uncompress it in the <code>web2py, gluon, contrib</code> folder.</p>
<p><strong>Note about images</strong>: these sample images are small so they may look like low quality ones. For better results, use bigger images: more DPI (screen is often 72/96DPI, printers are often 300/600DPI). As a rule of thumb, use at least half of the image size when rendering to PDF, ie. if an image is 500x200px, use 250x100px as width and height attributes of the IMG tag.</p>
<h1 id="sample-report">Sample Report</h1>
<p>You could make a "professional looking" bussiness report just using web2py HTML helpers, mixin headers, logos, charts, text and tables.</p>
<p>The main advantage of this method is that the same report can be rendered in a HTML view, or can be downloaded as PDF, with a minimal effort:</p>
<p>Sample: <a href="http://pyfpdf.googlecode.com/files/report.pdf">report.pdf</a></p>
<p>Updated Live Demo (HTML and PDF version):</p>
<ul>
<li><a href="http://www.web2py.com.ar/fpdf/default/report">http://www.web2py.com.ar/fpdf/default/report</a></li>
<li><a href="http://www.web2py.com.ar/fpdf/default/report.pdf">http://www.web2py.com.ar/fpdf/default/report.pdf</a></li>
</ul>
<pre><code class="python">def report():
    response.title = &quot;web2py sample report&quot;

    # include a google chart (download it dynamically!)
    url = &quot;http://chart.apis.google.com/chart?cht=p3&amp;chd=t:60,40&amp;chs=500x200&amp;chl=Hello|World&amp;.png&quot;
    chart = IMG(_src=url, _width=&quot;250&quot;, _height=&quot;100&quot;)

    # create a small table with some data:
    rows = [THEAD(TR(TH(&quot;Key&quot;, _width=&quot;70%&quot;), TH(&quot;Value&quot;, _width=&quot;30%&quot;))),
            TBODY(TR(TD(&quot;Hello&quot;), TD(&quot;60&quot;)), 
                  TR(TD(&quot;World&quot;), TD(&quot;40&quot;)))]
    table = TABLE(*rows, _border=&quot;0&quot;, _align=&quot;center&quot;, _width=&quot;50%&quot;)

    if request.extension == &quot;pdf&quot;:
        from gluon.contrib.pyfpdf import FPDF, HTMLMixin

        # create a custom class with the required functionality 
        class MyFPDF(FPDF, HTMLMixin):
            def header(self): 
                &quot;hook to draw custom page header (logo and title)&quot;
                logo = os.path.join(request.env.web2py_path, &quot;gluon&quot;, &quot;contrib&quot;, &quot;pyfpdf&quot;, &quot;tutorial&quot;, &quot;logo_pb.png&quot;)
                self.image(logo, 10, 8, 33)
                self.set_font('Arial', 'B', 15)
                self.cell(65) # padding
                self.cell(60, 10, response.title, 1, 0, 'C')
                self.ln(20)

            def footer(self):
                &quot;hook to draw custom page footer (printing page numbers)&quot;
                self.set_y(-15)
                self.set_font('Arial', 'I', 8)
                txt = 'Page %s of %s' % (self.page_no(), self.alias_nb_pages())
                self.cell(0, 10, txt, 0, 0, 'C')

        pdf = MyFPDF()
        # create a page and serialize/render HTML objects
        pdf.add_page()
        pdf.write_html(str(XML(table, sanitize=False)))
        pdf.write_html(str(XML(CENTER(chart), sanitize=False)))
        # prepare PDF to download:
        response.headers['Content-Type'] = 'application/pdf'
        return pdf.output(dest='S')
    else:
        # normal html view:
        return dict(chart=chart, table=table)

</code></pre>

<h1 id="sample-table-listing">Sample Table Listing</h1>
<p>Also, you can make nice tables that automatically spreads over several pages, with headers and footers, column and row highlighting, etc., in a very pythonic way:</p>
<p>Sample: <a href="http://pyfpdf.googlecode.com/files/listing.pdf">listing.pdf</a></p>
<p>Updated Live Demo (HTML and PDF version):</p>
<ul>
<li><a href="http://www.web2py.com.ar/fpdf/default/listing">http://www.web2py.com.ar/fpdf/default/listing</a></li>
<li><a href="http://www.web2py.com.ar/fpdf/default/listing.pdf">http://www.web2py.com.ar/fpdf/default/listing.pdf</a></li>
</ul>
<pre><code class="python">def listing():
    response.title = &quot;web2py sample listing&quot;

    # define header and footers:
    head = THEAD(TR(TH(&quot;Header 1&quot;, _width=&quot;50%&quot;), 
                    TH(&quot;Header 2&quot;, _width=&quot;30%&quot;),
                    TH(&quot;Header 3&quot;, _width=&quot;20%&quot;), 
                    _bgcolor=&quot;#A0A0A0&quot;))
    foot = TFOOT(TR(TH(&quot;Footer 1&quot;, _width=&quot;50%&quot;), 
                    TH(&quot;Footer 2&quot;, _width=&quot;30%&quot;),
                    TH(&quot;Footer 3&quot;, _width=&quot;20%&quot;),
                    _bgcolor=&quot;#E0E0E0&quot;))

    # create several rows:
    rows = []
    for i in range(1000):
        col = i % 2 and &quot;#F0F0F0&quot; or &quot;#FFFFFF&quot;
        rows.append(TR(TD(&quot;Row %s&quot; %i),
                       TD(&quot;something&quot;, _align=&quot;center&quot;),
                       TD(&quot;%s&quot; % i, _align=&quot;right&quot;),
                       _bgcolor=col)) 

    # make the table object
    body = TBODY(*rows)
    table = TABLE(*[head, foot, body], 
                  _border=&quot;1&quot;, _align=&quot;center&quot;, _width=&quot;100%&quot;)

    if request.extension == &quot;pdf&quot;:
        from gluon.contrib.pyfpdf import FPDF, HTMLMixin

        # define our FPDF class (move to modules if it is reused frequently)
        class MyFPDF(FPDF, HTMLMixin):
            def header(self):
                self.set_font('Arial', 'B', 15)
                self.cell(0, 10, response.title, 1, 0, 'C')
                self.ln(20)

            def footer(self):
                self.set_y(-15)
                self.set_font('Arial', 'I', 8)
                txt = 'Page %s of %s' % (self.page_no(), self.alias_nb_pages())
                self.cell(0, 10, txt, 0, 0, 'C')

        pdf = MyFPDF()
        # first page:
        pdf.add_page()
        pdf.write_html(str(XML(table, sanitize=False)))
        response.headers['Content-Type'] = 'application/pdf'
        return pdf.output(dest='S')
    else:
        # normal html view:
        return dict(table=table)}}}
</code></pre>

<h1 id="samples-template-definitions">Samples Template Definitions</h1>
<p>As stated in the <a href="Templates.html">Templates</a> page, there are 3 ways of putting your templates in place. As in that page there are samples for the manually hardcoded way and CSV document loading. Here we will only show a sample of the template engine.</p>
<h1 id="sample-templating-engine">Sample Templating Engine</h1>
<p>PyFPDF and web2py can be used to make PDF documents using templates like invoices, badges, certificates, etc.:</p>
<p>Sample: <a href="http://pyfpdf.googlecode.com/files/invoice.pdf">invoice.pdf</a></p>
<p>Updated Live Demo: <a href="http://www.web2py.com.ar/fpdf/default/invoice.pdf">http://www.web2py.com.ar/fpdf/default/invoice.pdf</a></p>
<p>To handle multiple templates, we can define two tables in web2py:</p>
<ul>
<li>pdf_template: general document information (name, paper size, etc.)</li>
<li>pdf_element: several rows for each document, describing graphics primitives and placeholders.</li>
</ul>
<p>In <code>db.py</code> write:</p>
<pre><code class="python">db.define_table(&quot;pdf_template&quot;,
    Field(&quot;pdf_template_id&quot;, &quot;id&quot;),
    Field(&quot;title&quot;),
    Field(&quot;format&quot;, requires=IS_IN_SET([&quot;A4&quot;, &quot;legal&quot;, &quot;letter&quot;])),
)

db.define_table(&quot;pdf_element&quot;,
    Field(&quot;pdf_template_id&quot;, db.pdf_template, requires=IS_IN_DB(db, 'pdf_template.pdf_template_id', 'pdf_template.title')),
    Field(&quot;name&quot;, requires=IS_NOT_EMPTY()),
    Field(&quot;type&quot;, length=2, requires=IS_IN_SET(['T', 'L', 'I', 'B', 'BC'])),
    Field(&quot;x1&quot;, &quot;double&quot;, requires=IS_NOT_EMPTY()),
    Field(&quot;y1&quot;, &quot;double&quot;, requires=IS_NOT_EMPTY()),
    Field(&quot;x2&quot;, &quot;double&quot;, requires=IS_NOT_EMPTY()),
    Field(&quot;y2&quot;, &quot;double&quot;, requires=IS_NOT_EMPTY()),
    Field(&quot;font&quot;, default=&quot;Arial&quot;, requires=IS_IN_SET(['Courier', 'Arial', 'Times', 'Symbol', 'Zapfdingbats'])),
    Field(&quot;size&quot;, &quot;double&quot;, default=&quot;10&quot;, requires=IS_NOT_EMPTY()),
    Field(&quot;bold&quot;, &quot;boolean&quot;),
    Field(&quot;italic&quot;, &quot;boolean&quot;),
    Field(&quot;underline&quot;, &quot;boolean&quot;),
    Field(&quot;foreground&quot;, &quot;integer&quot;, default=0x000000, comment=&quot;Color text&quot;),
    Field(&quot;background&quot;, &quot;integer&quot;, default=0xFFFFFF, comment=&quot;Fill color&quot;),
    Field(&quot;align&quot;, &quot;string&quot;, length=1, default=&quot;L&quot;, requires=IS_IN_SET(['L', 'R', 'C', 'J'])),
    Field(&quot;text&quot;, &quot;text&quot;, comment=&quot;Default text&quot;),
    Field(&quot;priority&quot;, &quot;integer&quot;, default=0, comment=&quot;Z-Order&quot;),
    )
</code></pre>

<p><strong>Warning</strong>: the fields "type", "size" and "text" are reserved words for some DB engines, so validation:</p>
<pre><code class="python">db = DAL('sqlite://storage.sqlite', pool_size=1, check_reserved=['ALL'])
</code></pre>

<p>will fail. sqlite, MySQL and postgres work OK. Proposals for new naming ideas are welcome.</p>
<p>At this point you could go to web2py AppAdmin and start to define your document templates, or use import/export functions to reuse your already defined formats!</p>
<p>Note: if you used designer.py to create the templates, and you want to import the templates with the Web2Py database admin, you will have to modify the file.</p>
<p>So, designer.py outputs a file like this:</p>
<pre><code>line0;T;20.0;13.0;190.0;13.0;times;10.0;0;0;0;0;65535;C;;0
line1;T;20.0;67.0;190.0;67.0;times;10.0;0;0;0;0;65535;C;;0
name0;T;21;14;104;25;times;16.0;0;0;0;0;0;C;;2
title0;T;64;26;104;30;times;10.0;0;0;0;0;0;C;;2
</code></pre>

<p>You will have to make it look lke this:</p>
<pre><code>pdf_element.pdf_template_id, pdf_element.name, pdf_element.type, pdf_element.x1, pdf_element.y1, pdf_element.x2, pdf_element.y2, pdf_element.font, pdf_element.size, pdf_element.bold, pdf_element.italic, pdf_element.underline, pdf_element.foreground, pdf_element.background, pdf_element.align, pdf_element.text, pdf_element.priority
1,line0,T,20.0,283.0,190.0,283.0,times,10.0,0,0,0,0,65535,C,,0
1,line1,T,20.0,337.0,190.0,337.0,times,10.0,0,0,0,0,65535,C,,0
1,name0,T,21,14,104,25,times,16.0,0,0,0,0,0,C,,2
1,title0,T,64,26,104,30,times,10.0,0,0,0,0,0,C,,2
</code></pre>

<p>Where the first number indicates the template ID (important for the database system), and the first line indicates the database fields to fill.</p>
<p>A simple Python script should do the trick.</p>
<p>After defining and filling your database, you can use PyFPDF <a href="Templates.html">Templates</a> directly reading row elements from the web2py database:</p>
<p>For example, for an invoice, in a controller you could write:</p>
<pre><code class="python">def invoice():
    from gluon.contrib.pyfpdf import Template
    import os.path

    # generate sample invoice (according Argentina's regulations)

    import random
    from decimal import Decimal

    # read elements from db 

    elements = db(db.pdf_element.pdf_template_id == 1).select(orderby=db.pdf_element.priority)

    f = Template(format=&quot;A4&quot;,
             elements = elements,
             title=&quot;Sample Invoice&quot;, author=&quot;Sample Company&quot;,
             subject=&quot;Sample Customer&quot;, keywords=&quot;Electronic TAX Invoice&quot;)

    # create some random invoice line items and detail data
    detail = &quot;Lorem ipsum dolor sit amet, consectetur. &quot; * 5
    items = []
    for i in range(1, 30):
        ds = &quot;Sample product %s&quot; % i
        qty = random.randint(1, 10)
        price = round(random.random() * 100, 3)
        code = &quot;%s%s%02d&quot; % (chr(random.randint(65, 90)), chr(random.randint(65, 90)), i)
        items.append(dict(code=code, unit='u',
                          qty=qty, price=price, 
                          amount=qty * price,
                          ds=&quot;%s: %s&quot; % (i, ds)))

    # divide and count lines
    lines = 0
    li_items = []
    for it in items:
        qty = it['qty']
        code = it['code']
        unit = it['unit']
        for ds in f.split_multicell(it['ds'], 'item_description01'):
            # add item description line (without price nor amount)
            li_items.append(dict(code=code, ds=ds, qty=qty, unit=unit, price=None, amount=None))
            # clean qty and code (show only at first)
            unit = qty = code = None
        # set last item line price and amount
        li_items[-1].update(amount = it['amount'],
                            price = it['price'])

    # split detail into each line description
    obs=&quot;\n&lt;U&gt;Detail:&lt;/U&gt;\n\n&quot; + detail
    for ds in f.split_multicell(obs, 'item_description01'):
        li_items.append(dict(code=code, ds=ds, qty=qty, unit=unit, price=None, amount=None))

    # calculate pages:
    lines = len(li_items)
    max_lines_per_page = 24
    pages = lines / (max_lines_per_page - 1)
    if lines % (max_lines_per_page - 1): pages = pages + 1

    # fill placeholders for each page
    for page in range(1, pages + 1):
        f.add_page()
        f['page'] = 'Page %s of %s' % (page, pages)
        if pages &gt; 1 and page &lt; pages:
            s = 'Continues on page %s' % (page + 1)
        else:
            s = ''
        f['item_description%02d' % (max_lines_per_page + 1)] = s

        f[&quot;company_name&quot;] = &quot;Sample Company&quot;
        f[&quot;company_logo&quot;] = os.path.join(request.env.web2py_path, &quot;gluon&quot;, &quot;contrib&quot;, &quot;pyfpdf&quot;, &quot;tutorial&quot;, &quot;logo.png&quot;)
        f[&quot;company_header1&quot;] = &quot;Some Address - somewhere -&quot;
        f[&quot;company_header2&quot;] = &quot;http://www.example.com&quot;        
        f[&quot;company_footer1&quot;] = &quot;Tax Code ...&quot;
        f[&quot;company_footer2&quot;] = &quot;Tax/VAT ID ...&quot;
        f['number'] = '0001-00001234'
        f['issue_date'] = '2010-09-10'
        f['due_date'] = '2099-09-10'
        f['customer_name'] = &quot;Sample Client&quot;
        f['customer_address'] = &quot;Siempreviva 1234&quot;

        # print line item...
        li = 0 
        k = 0
        total = Decimal(&quot;0.00&quot;)
        for it in li_items:
            k = k + 1
            if k &gt; page * (max_lines_per_page - 1):
                break
            if it['amount']:
                total += Decimal(&quot;%.6f&quot; % it['amount'])
            if k &gt; (page - 1) * (max_lines_per_page - 1):
                li += 1
                if it['qty'] is not None:
                    f['item_quantity%02d' % li] = it['qty']
                if it['code'] is not None:
                    f['item_code%02d' % li] = it['code']
                if it['unit'] is not None:
                    f['item_unit%02d' % li] = it['unit']
                f['item_description%02d' % li] = it['ds']
                if it['price'] is not None:
                    f['item_price%02d' % li] = &quot;%0.3f&quot; % it['price']
                if it['amount'] is not None:
                    f['item_amount%02d' % li] = &quot;%0.2f&quot; % it['amount']

        # last page? print totals:
        if pages == page:
            f['net'] = &quot;%0.2f&quot; % (total / Decimal(&quot;1.21&quot;))
            f['vat'] = &quot;%0.2f&quot; % (total * (1 - 1 / Decimal(&quot;1.21&quot;)))
            f['total_label'] = 'Total:'
        else:
            f['total_label'] = 'SubTotal:'
        f['total'] = &quot;%0.2f&quot; % total

    response.headers['Content-Type'] = 'application/pdf'
    return f.render('invoice.pdf', dest='S')
</code></pre>

<p>Of course, this is a hardcoded example. You can use the database to store invoices or any other data; there is no rigid class hierachy to follow, just fill your template like a dict!</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="assets/javascripts/application.ac79c3b0.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"."}})</script>
      
    
  </body>
</html>