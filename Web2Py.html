
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="fpdf2 - minimalist PDF creation library for Python" name="description"/>
<link href="https://pyfpdf.github.io/fpdf2/Web2Py.html" rel="canonical"/>
<link href="assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.2.3, mkdocs-material-7.3.6" name="generator"/>
<title>Web2Py - fpdf2</title>
<link href="assets/stylesheets/main.a57b2b03.min.css" rel="stylesheet"/>
<link href="assets/stylesheets/palette.3f5d1f46.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
<meta content="website" property="og:type">
<meta content="fpdf2 - Web2Py" property="og:title">
<meta content="fpdf2 - minimalist PDF creation library for Python" property="og:description">
<meta content="https://pyfpdf.github.io/fpdf2/Web2Py.html" property="og:url">
<meta content="https://pyfpdf.github.io/fpdf2/fpdf2-logo.png" property="og:image"/>
<meta content="image/png" property="og:image:type"/>
<meta content="500" property="og:image:width"/>
<meta content="500" property="og:image:height"/>
</meta></meta></meta></meta></head>
<body data-md-color-accent="none" data-md-color-primary="none" data-md-color-scheme="" dir="ltr">
<script>function __prefix(e){return new URL(".",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#web2py">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="fpdf2" class="md-header__button md-logo" data-md-component="logo" href="index.html" title="fpdf2">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            fpdf2
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Web2Py
            
          </span>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/PyFPDF/fpdf2/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="fpdf2" class="md-nav__button md-logo" data-md-component="logo" href="index.html" title="fpdf2">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"></path></svg>
</a>
    fpdf2
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/PyFPDF/fpdf2/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="index.html">
        Project Home
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="Tutorial.html">
        Tutorial
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="ExistingPDFs.html">
        Existing PDFs
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="HTML.html">
        HTML
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="Images.html">
        Images
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="Links.html">
        Links
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="Tables.html">
        Tables
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" id="__nav_8" type="checkbox"/>
<label class="md-nav__link" for="__nav_8">
          Layout
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Layout" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_8">
<span class="md-nav__icon md-icon"></span>
          Layout
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="PageFormatAndOrientation.html">
        Page format and orientation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="Margins.html">
        Margins
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="PageBreaks.html">
        Page breaks
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="DocumentOutlineAndTableOfContents.html">
        Document outline &amp; table of contents
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="TextStyling.html">
        Text styling
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="Presentations.html">
        Presentations
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="Annotations.html">
        Annotations
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="Shapes.html">
        Shapes
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="Maths.html">
        Maths
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="Barcodes.html">
        Barcodes
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="Metadata.html">
        Metadata
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="Logging.html">
        Logging
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="Templates.html">
        Templates
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="Unicode.html">
        Unicode
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          Web2Py
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="Web2Py.html">
        Web2Py
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#sample-report">
    Sample Report
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#sample-table-listing">
    Sample Table Listing
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#samples-template-definitions">
    Samples Template Definitions
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#sample-templating-engine">
    Sample Templating Engine
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://pyfpdf.github.io/fpdf2/fpdf/">
        API
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="Development.html">
        Development
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="FAQ.html">
        FAQ
      </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#sample-report">
    Sample Report
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#sample-table-listing">
    Sample Table Listing
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#samples-template-definitions">
    Samples Template Definitions
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#sample-templating-engine">
    Sample Templating Engine
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/PyFPDF/fpdf2/edit/master/docs/Web2Py.md" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"></path></svg>
</a>
<h1 id="web2py">Web2Py</h1>
<p>If you use <a href="http://www.web2py.com">web2py</a>, you can make complex reports that can be viewed in a browser, or downloaded as PDF (taking advantage of web2py HTML helper objects to easily diagram a report). See <a href="HTML.html">write_html</a> for more information, supported tags and attributes, etc.</p>
<p>Also, using web2py DAL, you can easily set up a templating engine for PDF documents. See <a href="Templates.html">Templates</a> for more information.</p>
<p>The following examples are packaged in a ready to run application:
<a href="http://pyfpdf.googlecode.com/files/web2py.app.fpdf.w2p">web2py.app.fpdf.w2p</a>.</p>
<p>PyFPDF is included in <a href="http://www.web2py.com/">web2py</a> since release <a href="http://www.web2py.com/examples/default/download">1.85.2</a>.</p>
<p>Also, you can put the content of the <code>fpdf/</code> directory in this repository into the <code>web2py/gluon/contrib</code> folder.</p>
<p><strong>Note about images</strong>: these sample images are small so they may look like low quality ones. For better results, use bigger images: more DPI (screen is often 72/96DPI, printers are often 300/600DPI). As a rule of thumb, use at least half of the image size when rendering to PDF, ie. if an image is 500x200px, use 250x100px as width and height attributes of the IMG tag.</p>
<h2 id="sample-report">Sample Report</h2>
<p>You could make a "professional looking" bussiness report just using web2py HTML helpers, mixin headers, logos, charts, text and tables.</p>
<p>The main advantage of this method is that the same report can be rendered in a HTML view, or can be downloaded as PDF, with a minimal effort:</p>
<p>Sample: <a href="http://pyfpdf.googlecode.com/files/report.pdf">report.pdf</a></p>
<p>Updated Live Demo (HTML and PDF version):</p>
<ul>
<li><a href="http://www.web2py.com.ar/fpdf/default/report">http://www.web2py.com.ar/fpdf/default/report</a></li>
<li><a href="http://www.web2py.com.ar/fpdf/default/report.pdf">http://www.web2py.com.ar/fpdf/default/report.pdf</a></li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">report</span><span class="p">():</span>
    <span class="n">response</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">"web2py sample report"</span>

    <span class="c1"># include a google chart (download it dynamically!)</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">"http://chart.apis.google.com/chart?cht=p3&amp;chd=t:60,40&amp;chs=500x200&amp;chl=Hello|World&amp;.png"</span>
    <span class="n">chart</span> <span class="o">=</span> <span class="n">IMG</span><span class="p">(</span><span class="n">_src</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">_width</span><span class="o">=</span><span class="s2">"250"</span><span class="p">,</span> <span class="n">_height</span><span class="o">=</span><span class="s2">"100"</span><span class="p">)</span>

    <span class="c1"># create a small table with some data:</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="p">[</span><span class="n">THEAD</span><span class="p">(</span><span class="n">TR</span><span class="p">(</span><span class="n">TH</span><span class="p">(</span><span class="s2">"Key"</span><span class="p">,</span> <span class="n">_width</span><span class="o">=</span><span class="s2">"70%"</span><span class="p">),</span> <span class="n">TH</span><span class="p">(</span><span class="s2">"Value"</span><span class="p">,</span> <span class="n">_width</span><span class="o">=</span><span class="s2">"30%"</span><span class="p">))),</span>
            <span class="n">TBODY</span><span class="p">(</span><span class="n">TR</span><span class="p">(</span><span class="n">TD</span><span class="p">(</span><span class="s2">"Hello"</span><span class="p">),</span> <span class="n">TD</span><span class="p">(</span><span class="s2">"60"</span><span class="p">)),</span> 
                  <span class="n">TR</span><span class="p">(</span><span class="n">TD</span><span class="p">(</span><span class="s2">"World"</span><span class="p">),</span> <span class="n">TD</span><span class="p">(</span><span class="s2">"40"</span><span class="p">)))]</span>
    <span class="n">table</span> <span class="o">=</span> <span class="n">TABLE</span><span class="p">(</span><span class="o">*</span><span class="n">rows</span><span class="p">,</span> <span class="n">_border</span><span class="o">=</span><span class="s2">"0"</span><span class="p">,</span> <span class="n">_align</span><span class="o">=</span><span class="s2">"center"</span><span class="p">,</span> <span class="n">_width</span><span class="o">=</span><span class="s2">"50%"</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">extension</span> <span class="o">==</span> <span class="s2">"pdf"</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">gluon.contrib.fpdf</span> <span class="kn">import</span> <span class="n">FPDF</span><span class="p">,</span> <span class="n">HTMLMixin</span>

        <span class="c1"># create a custom class with the required functionality </span>
        <span class="k">class</span> <span class="nc">MyFPDF</span><span class="p">(</span><span class="n">FPDF</span><span class="p">,</span> <span class="n">HTMLMixin</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">header</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
                <span class="sd">"""hook to draw custom page header (logo and title)"""</span>
                <span class="n">logo</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">web2py_path</span><span class="p">,</span> <span class="s2">"gluon"</span><span class="p">,</span> <span class="s2">"contrib"</span><span class="p">,</span> <span class="s2">"pyfpdf"</span><span class="p">,</span> <span class="s2">"tutorial"</span><span class="p">,</span> <span class="s2">"logo_pb.png"</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">(</span><span class="n">logo</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">33</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s1">'helvetica'</span><span class="p">,</span> <span class="s1">'B'</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">65</span><span class="p">)</span> <span class="c1"># padding</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'C'</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ln</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>

            <span class="k">def</span> <span class="nf">footer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="sd">"""hook to draw custom page footer (printing page numbers)"""</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_y</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s1">'helvetica'</span><span class="p">,</span> <span class="s1">'I'</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
                <span class="n">txt</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">'Page </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">page_no</span><span class="p">()</span><span class="si">}</span><span class="s1"> of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">alias_nb_pages</span><span class="p">()</span><span class="si">}</span><span class="s1">'</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">txt</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'C'</span><span class="p">)</span>

        <span class="n">pdf</span> <span class="o">=</span> <span class="n">MyFPDF</span><span class="p">()</span>
        <span class="c1"># create a page and serialize/render HTML objects</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">add_page</span><span class="p">()</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">write_html</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">XML</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">sanitize</span><span class="o">=</span><span class="kc">False</span><span class="p">)))</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">write_html</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">XML</span><span class="p">(</span><span class="n">CENTER</span><span class="p">(</span><span class="n">chart</span><span class="p">),</span> <span class="n">sanitize</span><span class="o">=</span><span class="kc">False</span><span class="p">)))</span>
        <span class="c1"># prepare PDF to download:</span>
        <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">'Content-Type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'application/pdf'</span>
        <span class="k">return</span> <span class="n">pdf</span><span class="o">.</span><span class="n">output</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># normal html view:</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="n">chart</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>
</code></pre></div>
<h2 id="sample-table-listing">Sample Table Listing</h2>
<p>Also, you can make nice tables that automatically spreads over several pages, with headers and footers, column and row highlighting, etc., in a very pythonic way:</p>
<p>Sample: <a href="http://pyfpdf.googlecode.com/files/listing.pdf">listing.pdf</a></p>
<p>Updated Live Demo (HTML and PDF version):</p>
<ul>
<li><a href="http://www.web2py.com.ar/fpdf/default/listing">http://www.web2py.com.ar/fpdf/default/listing</a></li>
<li><a href="http://www.web2py.com.ar/fpdf/default/listing.pdf">http://www.web2py.com.ar/fpdf/default/listing.pdf</a></li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">listing</span><span class="p">():</span>
    <span class="n">response</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">"web2py sample listing"</span>

    <span class="c1"># define header and footers:</span>
    <span class="n">head</span> <span class="o">=</span> <span class="n">THEAD</span><span class="p">(</span><span class="n">TR</span><span class="p">(</span><span class="n">TH</span><span class="p">(</span><span class="s2">"Header 1"</span><span class="p">,</span> <span class="n">_width</span><span class="o">=</span><span class="s2">"50%"</span><span class="p">),</span> 
                    <span class="n">TH</span><span class="p">(</span><span class="s2">"Header 2"</span><span class="p">,</span> <span class="n">_width</span><span class="o">=</span><span class="s2">"30%"</span><span class="p">),</span>
                    <span class="n">TH</span><span class="p">(</span><span class="s2">"Header 3"</span><span class="p">,</span> <span class="n">_width</span><span class="o">=</span><span class="s2">"20%"</span><span class="p">),</span> 
                    <span class="n">_bgcolor</span><span class="o">=</span><span class="s2">"#A0A0A0"</span><span class="p">))</span>
    <span class="n">foot</span> <span class="o">=</span> <span class="n">TFOOT</span><span class="p">(</span><span class="n">TR</span><span class="p">(</span><span class="n">TH</span><span class="p">(</span><span class="s2">"Footer 1"</span><span class="p">,</span> <span class="n">_width</span><span class="o">=</span><span class="s2">"50%"</span><span class="p">),</span> 
                    <span class="n">TH</span><span class="p">(</span><span class="s2">"Footer 2"</span><span class="p">,</span> <span class="n">_width</span><span class="o">=</span><span class="s2">"30%"</span><span class="p">),</span>
                    <span class="n">TH</span><span class="p">(</span><span class="s2">"Footer 3"</span><span class="p">,</span> <span class="n">_width</span><span class="o">=</span><span class="s2">"20%"</span><span class="p">),</span>
                    <span class="n">_bgcolor</span><span class="o">=</span><span class="s2">"#E0E0E0"</span><span class="p">))</span>

    <span class="c1"># create several rows:</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="ow">and</span> <span class="s2">"#F0F0F0"</span> <span class="ow">or</span> <span class="s2">"#FFFFFF"</span>
        <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">TR</span><span class="p">(</span><span class="n">TD</span><span class="p">(</span><span class="s2">"Row </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span><span class="n">i</span><span class="p">),</span>
                       <span class="n">TD</span><span class="p">(</span><span class="s2">"something"</span><span class="p">,</span> <span class="n">_align</span><span class="o">=</span><span class="s2">"center"</span><span class="p">),</span>
                       <span class="n">TD</span><span class="p">(</span><span class="s2">"</span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span> <span class="n">_align</span><span class="o">=</span><span class="s2">"right"</span><span class="p">),</span>
                       <span class="n">_bgcolor</span><span class="o">=</span><span class="n">col</span><span class="p">))</span> 

    <span class="c1"># make the table object</span>
    <span class="n">body</span> <span class="o">=</span> <span class="n">TBODY</span><span class="p">(</span><span class="o">*</span><span class="n">rows</span><span class="p">)</span>
    <span class="n">table</span> <span class="o">=</span> <span class="n">TABLE</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">head</span><span class="p">,</span> <span class="n">foot</span><span class="p">,</span> <span class="n">body</span><span class="p">],</span> 
                  <span class="n">_border</span><span class="o">=</span><span class="s2">"1"</span><span class="p">,</span> <span class="n">_align</span><span class="o">=</span><span class="s2">"center"</span><span class="p">,</span> <span class="n">_width</span><span class="o">=</span><span class="s2">"100%"</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">extension</span> <span class="o">==</span> <span class="s2">"pdf"</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">gluon.contrib.fpdf</span> <span class="kn">import</span> <span class="n">FPDF</span><span class="p">,</span> <span class="n">HTMLMixin</span>

        <span class="c1"># define our FPDF class (move to modules if it is reused frequently)</span>
        <span class="k">class</span> <span class="nc">MyFPDF</span><span class="p">(</span><span class="n">FPDF</span><span class="p">,</span> <span class="n">HTMLMixin</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">header</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s1">'helvetica'</span><span class="p">,</span> <span class="s1">'B'</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'C'</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ln</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>

            <span class="k">def</span> <span class="nf">footer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_y</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s1">'helvetica'</span><span class="p">,</span> <span class="s1">'I'</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
                <span class="n">txt</span> <span class="o">=</span> <span class="s1">'Page </span><span class="si">%s</span><span class="s1"> of </span><span class="si">%s</span><span class="s1">'</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">page_no</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">alias_nb_pages</span><span class="p">())</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">txt</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'C'</span><span class="p">)</span>

        <span class="n">pdf</span> <span class="o">=</span> <span class="n">MyFPDF</span><span class="p">()</span>
        <span class="c1"># first page:</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">add_page</span><span class="p">()</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">write_html</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">XML</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">sanitize</span><span class="o">=</span><span class="kc">False</span><span class="p">)))</span>
        <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">'Content-Type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'application/pdf'</span>
        <span class="k">return</span> <span class="n">pdf</span><span class="o">.</span><span class="n">output</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># normal html view:</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">)}}}</span>
</code></pre></div>
<h2 id="samples-template-definitions">Samples Template Definitions</h2>
<p>As stated in the <a href="Templates.html">Templates</a> page, there are 3 ways of putting your templates in place.
As in that page there are samples for the manually hardcoded way and CSV document loading.
Here we will only show a sample of the template engine.</p>
<h2 id="sample-templating-engine">Sample Templating Engine</h2>
<p>PyFPDF and web2py can be used to make PDF documents using templates like invoices, badges, certificates, etc.:</p>
<p>Sample: <a href="http://pyfpdf.googlecode.com/files/invoice.pdf">invoice.pdf</a></p>
<p>Updated Live Demo: <a href="http://www.web2py.com.ar/fpdf/default/invoice.pdf">http://www.web2py.com.ar/fpdf/default/invoice.pdf</a></p>
<p>To handle multiple templates, we can define two tables in web2py:</p>
<ul>
<li>pdf_template: general document information (name, paper size, etc.)</li>
<li>pdf_element: several rows for each document, describing graphics primitives and placeholders.</li>
</ul>
<p>In <code>db.py</code> write:
<div class="highlight"><pre><span></span><code><span class="n">db</span><span class="o">.</span><span class="n">define_table</span><span class="p">(</span><span class="s2">"pdf_template"</span><span class="p">,</span>
    <span class="n">Field</span><span class="p">(</span><span class="s2">"pdf_template_id"</span><span class="p">,</span> <span class="s2">"id"</span><span class="p">),</span>
    <span class="n">Field</span><span class="p">(</span><span class="s2">"title"</span><span class="p">),</span>
    <span class="n">Field</span><span class="p">(</span><span class="s2">"format"</span><span class="p">,</span> <span class="n">requires</span><span class="o">=</span><span class="n">IS_IN_SET</span><span class="p">([</span><span class="s2">"A4"</span><span class="p">,</span> <span class="s2">"legal"</span><span class="p">,</span> <span class="s2">"letter"</span><span class="p">])),</span>
<span class="p">)</span>

<span class="n">db</span><span class="o">.</span><span class="n">define_table</span><span class="p">(</span><span class="s2">"pdf_element"</span><span class="p">,</span>
    <span class="n">Field</span><span class="p">(</span><span class="s2">"pdf_template_id"</span><span class="p">,</span> <span class="n">db</span><span class="o">.</span><span class="n">pdf_template</span><span class="p">,</span> <span class="n">requires</span><span class="o">=</span><span class="n">IS_IN_DB</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="s1">'pdf_template.pdf_template_id'</span><span class="p">,</span> <span class="s1">'pdf_template.title'</span><span class="p">)),</span>
    <span class="n">Field</span><span class="p">(</span><span class="s2">"name"</span><span class="p">,</span> <span class="n">requires</span><span class="o">=</span><span class="n">IS_NOT_EMPTY</span><span class="p">()),</span>
    <span class="n">Field</span><span class="p">(</span><span class="s2">"type"</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">requires</span><span class="o">=</span><span class="n">IS_IN_SET</span><span class="p">([</span><span class="s1">'T'</span><span class="p">,</span> <span class="s1">'L'</span><span class="p">,</span> <span class="s1">'I'</span><span class="p">,</span> <span class="s1">'B'</span><span class="p">,</span> <span class="s1">'BC'</span><span class="p">])),</span>
    <span class="n">Field</span><span class="p">(</span><span class="s2">"x1"</span><span class="p">,</span> <span class="s2">"double"</span><span class="p">,</span> <span class="n">requires</span><span class="o">=</span><span class="n">IS_NOT_EMPTY</span><span class="p">()),</span>
    <span class="n">Field</span><span class="p">(</span><span class="s2">"y1"</span><span class="p">,</span> <span class="s2">"double"</span><span class="p">,</span> <span class="n">requires</span><span class="o">=</span><span class="n">IS_NOT_EMPTY</span><span class="p">()),</span>
    <span class="n">Field</span><span class="p">(</span><span class="s2">"x2"</span><span class="p">,</span> <span class="s2">"double"</span><span class="p">,</span> <span class="n">requires</span><span class="o">=</span><span class="n">IS_NOT_EMPTY</span><span class="p">()),</span>
    <span class="n">Field</span><span class="p">(</span><span class="s2">"y2"</span><span class="p">,</span> <span class="s2">"double"</span><span class="p">,</span> <span class="n">requires</span><span class="o">=</span><span class="n">IS_NOT_EMPTY</span><span class="p">()),</span>
    <span class="n">Field</span><span class="p">(</span><span class="s2">"font"</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">"helvetica"</span><span class="p">,</span> <span class="n">requires</span><span class="o">=</span><span class="n">IS_IN_SET</span><span class="p">([</span><span class="s1">'Courier'</span><span class="p">,</span> <span class="s1">'helvetica'</span><span class="p">,</span> <span class="s1">'Times'</span><span class="p">,</span> <span class="s1">'Symbol'</span><span class="p">,</span> <span class="s1">'Zapfdingbats'</span><span class="p">])),</span>
    <span class="n">Field</span><span class="p">(</span><span class="s2">"size"</span><span class="p">,</span> <span class="s2">"double"</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">"10"</span><span class="p">,</span> <span class="n">requires</span><span class="o">=</span><span class="n">IS_NOT_EMPTY</span><span class="p">()),</span>
    <span class="n">Field</span><span class="p">(</span><span class="s2">"bold"</span><span class="p">,</span> <span class="s2">"boolean"</span><span class="p">),</span>
    <span class="n">Field</span><span class="p">(</span><span class="s2">"italic"</span><span class="p">,</span> <span class="s2">"boolean"</span><span class="p">),</span>
    <span class="n">Field</span><span class="p">(</span><span class="s2">"underline"</span><span class="p">,</span> <span class="s2">"boolean"</span><span class="p">),</span>
    <span class="n">Field</span><span class="p">(</span><span class="s2">"foreground"</span><span class="p">,</span> <span class="s2">"integer"</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mh">0x000000</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s2">"Color text"</span><span class="p">),</span>
    <span class="n">Field</span><span class="p">(</span><span class="s2">"background"</span><span class="p">,</span> <span class="s2">"integer"</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mh">0xFFFFFF</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s2">"Fill color"</span><span class="p">),</span>
    <span class="n">Field</span><span class="p">(</span><span class="s2">"align"</span><span class="p">,</span> <span class="s2">"string"</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">"L"</span><span class="p">,</span> <span class="n">requires</span><span class="o">=</span><span class="n">IS_IN_SET</span><span class="p">([</span><span class="s1">'L'</span><span class="p">,</span> <span class="s1">'R'</span><span class="p">,</span> <span class="s1">'C'</span><span class="p">,</span> <span class="s1">'J'</span><span class="p">])),</span>
    <span class="n">Field</span><span class="p">(</span><span class="s2">"text"</span><span class="p">,</span> <span class="s2">"text"</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s2">"Default text"</span><span class="p">),</span>
    <span class="n">Field</span><span class="p">(</span><span class="s2">"priority"</span><span class="p">,</span> <span class="s2">"integer"</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s2">"Z-Order"</span><span class="p">),</span>
    <span class="p">)</span>
</code></pre></div></p>
<p><strong>Warning</strong>: the fields "type", "size" and "text" are reserved words for some DB engines, so validation:</p>
<p><div class="highlight"><pre><span></span><code><span class="n">db</span> <span class="o">=</span> <span class="n">DAL</span><span class="p">(</span><span class="s1">'sqlite://storage.sqlite'</span><span class="p">,</span> <span class="n">pool_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">check_reserved</span><span class="o">=</span><span class="p">[</span><span class="s1">'ALL'</span><span class="p">])</span>
</code></pre></div>
will fail. sqlite, MySQL and postgres work OK. Proposals for new naming ideas are welcome.</p>
<p>At this point you could go to web2py AppAdmin and start to define your document templates, or use import/export functions to reuse your already defined formats!</p>
<p>Note: if you used designer.py to create the templates, and you want to import the templates with the Web2Py database admin, you will have to modify the file.</p>
<p>So, designer.py outputs a file like this:
<div class="highlight"><pre><span></span><code>line0;T;20.0;13.0;190.0;13.0;times;10.0;0;0;0;0;65535;C;;0
line1;T;20.0;67.0;190.0;67.0;times;10.0;0;0;0;0;65535;C;;0
name0;T;21;14;104;25;times;16.0;0;0;0;0;0;C;;2
title0;T;64;26;104;30;times;10.0;0;0;0;0;0;C;;2
</code></pre></div></p>
<p>You will have to make it look lke this:</p>
<p><div class="highlight"><pre><span></span><code>pdf_element.pdf_template_id, pdf_element.name, pdf_element.type, pdf_element.x1, pdf_element.y1, pdf_element.x2, pdf_element.y2, pdf_element.font, pdf_element.size, pdf_element.bold, pdf_element.italic, pdf_element.underline, pdf_element.foreground, pdf_element.background, pdf_element.align, pdf_element.text, pdf_element.priority
1,line0,T,20.0,283.0,190.0,283.0,times,10.0,0,0,0,0,65535,C,,0
1,line1,T,20.0,337.0,190.0,337.0,times,10.0,0,0,0,0,65535,C,,0
1,name0,T,21,14,104,25,times,16.0,0,0,0,0,0,C,,2
1,title0,T,64,26,104,30,times,10.0,0,0,0,0,0,C,,2
</code></pre></div>
Where the first number indicates the template ID (important for the database system), and the first line indicates the database fields to fill.</p>
<p>A simple Python script should do the trick.</p>
<p>After defining and filling your database, you can use PyFPDF <a href="Templates.html">Templates</a> directly reading row elements from the web2py database:</p>
<p>For example, for an invoice, in a controller you could write:
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">invoice</span><span class="p">():</span>
    <span class="kn">from</span> <span class="nn">gluon.contrib.fpdf</span> <span class="kn">import</span> <span class="n">Template</span>
    <span class="kn">import</span> <span class="nn">os.path</span>

    <span class="c1"># generate sample invoice (according Argentina's regulations)</span>

    <span class="kn">import</span> <span class="nn">random</span>
    <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>

    <span class="c1"># read elements from db </span>

    <span class="n">elements</span> <span class="o">=</span> <span class="n">db</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">pdf_element</span><span class="o">.</span><span class="n">pdf_template_id</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">orderby</span><span class="o">=</span><span class="n">db</span><span class="o">.</span><span class="n">pdf_element</span><span class="o">.</span><span class="n">priority</span><span class="p">)</span>

    <span class="n">f</span> <span class="o">=</span> <span class="n">Template</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s2">"A4"</span><span class="p">,</span>
                 <span class="n">elements</span> <span class="o">=</span> <span class="n">elements</span><span class="p">,</span>
                 <span class="n">title</span><span class="o">=</span><span class="s2">"Sample Invoice"</span><span class="p">,</span> <span class="n">author</span><span class="o">=</span><span class="s2">"Sample Company"</span><span class="p">,</span>
                 <span class="n">subject</span><span class="o">=</span><span class="s2">"Sample Customer"</span><span class="p">,</span> <span class="n">keywords</span><span class="o">=</span><span class="s2">"Electronic TAX Invoice"</span><span class="p">)</span>

    <span class="c1"># create some random invoice line items and detail data</span>
    <span class="n">detail</span> <span class="o">=</span> <span class="s2">"Lorem ipsum dolor sit amet, consectetur. "</span> <span class="o">*</span> <span class="mi">5</span>
    <span class="n">items</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">):</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="s2">"Sample product </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="n">i</span>
        <span class="n">qty</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">price</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">code</span> <span class="o">=</span> <span class="s2">"</span><span class="si">%s%s%02d</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">65</span><span class="p">,</span> <span class="mi">90</span><span class="p">)),</span> <span class="nb">chr</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">65</span><span class="p">,</span> <span class="mi">90</span><span class="p">)),</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="n">code</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">'u'</span><span class="p">,</span>
                          <span class="n">qty</span><span class="o">=</span><span class="n">qty</span><span class="p">,</span> <span class="n">price</span><span class="o">=</span><span class="n">price</span><span class="p">,</span> 
                          <span class="n">amount</span><span class="o">=</span><span class="n">qty</span> <span class="o">*</span> <span class="n">price</span><span class="p">,</span>
                          <span class="n">ds</span><span class="o">=</span><span class="s2">"</span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">ds</span><span class="p">)))</span>

    <span class="c1"># divide and count lines</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">li_items</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
        <span class="n">qty</span> <span class="o">=</span> <span class="n">it</span><span class="p">[</span><span class="s1">'qty'</span><span class="p">]</span>
        <span class="n">code</span> <span class="o">=</span> <span class="n">it</span><span class="p">[</span><span class="s1">'code'</span><span class="p">]</span>
        <span class="n">unit</span> <span class="o">=</span> <span class="n">it</span><span class="p">[</span><span class="s1">'unit'</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">split_multicell</span><span class="p">(</span><span class="n">it</span><span class="p">[</span><span class="s1">'ds'</span><span class="p">],</span> <span class="s1">'item_description01'</span><span class="p">):</span>
            <span class="c1"># add item description line (without price nor amount)</span>
            <span class="n">li_items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="n">code</span><span class="p">,</span> <span class="n">ds</span><span class="o">=</span><span class="n">ds</span><span class="p">,</span> <span class="n">qty</span><span class="o">=</span><span class="n">qty</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="n">price</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">amount</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
            <span class="c1"># clean qty and code (show only at first)</span>
            <span class="n">unit</span> <span class="o">=</span> <span class="n">qty</span> <span class="o">=</span> <span class="n">code</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># set last item line price and amount</span>
        <span class="n">li_items</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">amount</span> <span class="o">=</span> <span class="n">it</span><span class="p">[</span><span class="s1">'amount'</span><span class="p">],</span>
                            <span class="n">price</span> <span class="o">=</span> <span class="n">it</span><span class="p">[</span><span class="s1">'price'</span><span class="p">])</span>

    <span class="c1"># split detail into each line description</span>
    <span class="n">obs</span><span class="o">=</span><span class="s2">"</span><span class="se">\n</span><span class="s2">&lt;U&gt;Detail:&lt;/U&gt;</span><span class="se">\n\n</span><span class="s2">"</span> <span class="o">+</span> <span class="n">detail</span>
    <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">split_multicell</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="s1">'item_description01'</span><span class="p">):</span>
        <span class="n">li_items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="n">code</span><span class="p">,</span> <span class="n">ds</span><span class="o">=</span><span class="n">ds</span><span class="p">,</span> <span class="n">qty</span><span class="o">=</span><span class="n">qty</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="n">price</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">amount</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>

    <span class="c1"># calculate pages:</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">li_items</span><span class="p">)</span>
    <span class="n">max_lines_per_page</span> <span class="o">=</span> <span class="mi">24</span>
    <span class="n">pages</span> <span class="o">=</span> <span class="n">lines</span> <span class="o">/</span> <span class="p">(</span><span class="n">max_lines_per_page</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">lines</span> <span class="o">%</span> <span class="p">(</span><span class="n">max_lines_per_page</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span> <span class="n">pages</span> <span class="o">=</span> <span class="n">pages</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="c1"># fill placeholders for each page</span>
    <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">pages</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">f</span><span class="o">.</span><span class="n">add_page</span><span class="p">()</span>
        <span class="n">f</span><span class="p">[</span><span class="s1">'page'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Page </span><span class="si">%s</span><span class="s1"> of </span><span class="si">%s</span><span class="s1">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">page</span><span class="p">,</span> <span class="n">pages</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pages</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">page</span> <span class="o">&lt;</span> <span class="n">pages</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="s1">'Continues on page </span><span class="si">%s</span><span class="s1">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">page</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="s1">''</span>
        <span class="n">f</span><span class="p">[</span><span class="s1">'item_description</span><span class="si">%02d</span><span class="s1">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">max_lines_per_page</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">s</span>

        <span class="n">f</span><span class="p">[</span><span class="s2">"company_name"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Sample Company"</span>
        <span class="n">f</span><span class="p">[</span><span class="s2">"company_logo"</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">web2py_path</span><span class="p">,</span> <span class="s2">"gluon"</span><span class="p">,</span> <span class="s2">"contrib"</span><span class="p">,</span> <span class="s2">"pyfpdf"</span><span class="p">,</span> <span class="s2">"tutorial"</span><span class="p">,</span> <span class="s2">"logo.png"</span><span class="p">)</span>
        <span class="n">f</span><span class="p">[</span><span class="s2">"company_header1"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Some Address - somewhere -"</span>
        <span class="n">f</span><span class="p">[</span><span class="s2">"company_header2"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"http://www.example.com"</span>        
        <span class="n">f</span><span class="p">[</span><span class="s2">"company_footer1"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Tax Code ..."</span>
        <span class="n">f</span><span class="p">[</span><span class="s2">"company_footer2"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Tax/VAT ID ..."</span>
        <span class="n">f</span><span class="p">[</span><span class="s1">'number'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'0001-00001234'</span>
        <span class="n">f</span><span class="p">[</span><span class="s1">'issue_date'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'2010-09-10'</span>
        <span class="n">f</span><span class="p">[</span><span class="s1">'due_date'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'2099-09-10'</span>
        <span class="n">f</span><span class="p">[</span><span class="s1">'customer_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Sample Client"</span>
        <span class="n">f</span><span class="p">[</span><span class="s1">'customer_address'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Siempreviva 1234"</span>

        <span class="c1"># print line item...</span>
        <span class="n">li</span> <span class="o">=</span> <span class="mi">0</span> 
        <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">total</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">"0.00"</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">li_items</span><span class="p">:</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="n">page</span> <span class="o">*</span> <span class="p">(</span><span class="n">max_lines_per_page</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">break</span>
            <span class="k">if</span> <span class="n">it</span><span class="p">[</span><span class="s1">'amount'</span><span class="p">]:</span>
                <span class="n">total</span> <span class="o">+=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">"</span><span class="si">%.6f</span><span class="s2">"</span> <span class="o">%</span> <span class="n">it</span><span class="p">[</span><span class="s1">'amount'</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">page</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">max_lines_per_page</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">li</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">it</span><span class="p">[</span><span class="s1">'qty'</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">f</span><span class="p">[</span><span class="s1">'item_quantity</span><span class="si">%02d</span><span class="s1">'</span> <span class="o">%</span> <span class="n">li</span><span class="p">]</span> <span class="o">=</span> <span class="n">it</span><span class="p">[</span><span class="s1">'qty'</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">it</span><span class="p">[</span><span class="s1">'code'</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">f</span><span class="p">[</span><span class="s1">'item_code</span><span class="si">%02d</span><span class="s1">'</span> <span class="o">%</span> <span class="n">li</span><span class="p">]</span> <span class="o">=</span> <span class="n">it</span><span class="p">[</span><span class="s1">'code'</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">it</span><span class="p">[</span><span class="s1">'unit'</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">f</span><span class="p">[</span><span class="s1">'item_unit</span><span class="si">%02d</span><span class="s1">'</span> <span class="o">%</span> <span class="n">li</span><span class="p">]</span> <span class="o">=</span> <span class="n">it</span><span class="p">[</span><span class="s1">'unit'</span><span class="p">]</span>
                <span class="n">f</span><span class="p">[</span><span class="s1">'item_description</span><span class="si">%02d</span><span class="s1">'</span> <span class="o">%</span> <span class="n">li</span><span class="p">]</span> <span class="o">=</span> <span class="n">it</span><span class="p">[</span><span class="s1">'ds'</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">it</span><span class="p">[</span><span class="s1">'price'</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">f</span><span class="p">[</span><span class="s1">'item_price</span><span class="si">%02d</span><span class="s1">'</span> <span class="o">%</span> <span class="n">li</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">%0.3f</span><span class="s2">"</span> <span class="o">%</span> <span class="n">it</span><span class="p">[</span><span class="s1">'price'</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">it</span><span class="p">[</span><span class="s1">'amount'</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">f</span><span class="p">[</span><span class="s1">'item_amount</span><span class="si">%02d</span><span class="s1">'</span> <span class="o">%</span> <span class="n">li</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">%0.2f</span><span class="s2">"</span> <span class="o">%</span> <span class="n">it</span><span class="p">[</span><span class="s1">'amount'</span><span class="p">]</span>

        <span class="c1"># last page? print totals:</span>
        <span class="k">if</span> <span class="n">pages</span> <span class="o">==</span> <span class="n">page</span><span class="p">:</span>
            <span class="n">f</span><span class="p">[</span><span class="s1">'net'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">%0.2f</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">total</span> <span class="o">/</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">"1.21"</span><span class="p">))</span>
            <span class="n">f</span><span class="p">[</span><span class="s1">'vat'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">%0.2f</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">total</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">"1.21"</span><span class="p">)))</span>
            <span class="n">f</span><span class="p">[</span><span class="s1">'total_label'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Total:'</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">f</span><span class="p">[</span><span class="s1">'total_label'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'SubTotal:'</span>
        <span class="n">f</span><span class="p">[</span><span class="s1">'total'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"</span><span class="si">%0.2f</span><span class="s2">"</span> <span class="o">%</span> <span class="n">total</span>

    <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">'Content-Type'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'application/pdf'</span>
    <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s1">'invoice.pdf'</span><span class="p">)</span>
</code></pre></div></p>
<p>Of course, this is a hardcoded example. You can use the database to store invoices or any other data;
there is no rigid class hierachy to follow, just fill your template like a dict!</p>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: Unicode" class="md-footer__link md-footer__link--prev" href="Unicode.html" rel="prev">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</div>
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Previous
              </span>
              Unicode
            </div>
</div>
</a>
<a aria-label="Next: Development" class="md-footer__link md-footer__link--next" href="Development.html" rel="next">
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Next
              </span>
              Development
            </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
            Material for MkDocs
          </a>
 ... <a class="link--pdf-download" download href="./fpdf2-manual.pdf" title="PDF">download PDF</a></div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "assets/javascripts/workers/search.fcfe8b6d.min.js", "version": null}</script>
<script src="assets/javascripts/bundle.b1047164.min.js"></script>
</body>
</html>